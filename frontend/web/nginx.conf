server {
  # Porta que o Nginx vai escutar dentro do container
  # No Docker, essa porta é mapeada depois no docker-compose
  listen 80;

  # Nome do servidor
  # Em produção isso vira o domínio (ex: app.meusite.com)
  server_name localhost;

  # Diretório onde o Nginx vai servir os arquivos estáticos
  # Esse caminho precisa bater com o COPY do Dockerfile
  root /usr/share/nginx/html;

  # Arquivo principal da SPA
  # Sempre que não existir rota física, o Nginx cai nele
  index index.html;

  # Ativa compressão gzip para reduzir tamanho das respostas
  # Isso deixa o site mais rápido e economiza banda
  gzip on;

  # Tipos de arquivo que realmente valem a pena comprimir
  # JS e CSS são os maiores ganhos aqui
  gzip_types
    text/plain
    text/css
    application/javascript
    application/json
    image/svg+xml;

  # Só comprime arquivos acima desse tamanho
  # Evita gastar CPU com arquivos muito pequenos
  gzip_min_length 256;

  # Rota principal da aplicação (SPA)
  location / {
    # Primeiro tenta achar o arquivo real (ex: /logo.png)
    # Depois tenta como pasta
    # Se não existir nada disso, retorna index.html
    # Isso é o que faz o React Router funcionar
    try_files $uri $uri/ /index.html;
  }

  # Cache de arquivos estáticos (JS, CSS, imagens, fontes)
  location ~* \.(?:ico|css|js|gif|jpe?g|png|svg|woff2?)$ {
    # Mantém esses arquivos em cache por 7 dias
    # Seguro se você ainda não estiver usando hash no build
    expires 7d;

    # Diz pro browser que esses arquivos podem ser cacheados
    # immutable evita revalidação desnecessária
    add_header Cache-Control "public, immutable";
  }
}
